<!-- HEADER PRINCIPAL -->
<header class="mt-lg-n6 mb-4">
    <h1 class="h4 mb-0">Cadastro de Categorias</h1>
</header>

<!-- Card de Listagem -->
<div class="section rounded mb-3">
    <div class="bg-white shadow-md rounded">
        <div class="p-4 border-bottom d-flex align-items-center justify-content-between">
            <h5 class="mb-0">Lista de Categorias</h5>
            <a href="<%= base_url('category/edit') %>" class="btn btn-primary">
                <i class="fi fi-plus me-2"></i>Nova Categoria
            </a>
        </div>
        <div class="p-4">
            <% if (categories && categories.length > 0) { %>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Código</th>
                                <th>Nome</th>
                                <th>Tipo</th>
                                <th>Múltiplo</th>
                                <th>Fluxo</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% categories.forEach(function(category) { %>
                                <tr>
                                    <td>
                                        <span class="badge bg-secondary"><%= category.code || '-' %></span>
                                    </td>
                                    <td>
                                        <strong><%= category.name %></strong>
                                    </td>
                                    <td>
                                        <% if (category.type === 'TICKET') { %>
                                            <span class="badge bg-primary">Ticket</span>
                                        <% } else if (category.type === 'CREDENCIADO') { %>
                                            <span class="badge bg-success">Credenciado</span>
                                        <% } else if (category.type === 'COLABORADOR') { %>
                                            <span class="badge bg-info">Colaborador</span>
                                        <% } else { %>
                                            <span class="badge bg-secondary"><%= category.type %></span>
                                        <% } %>
                                    </td>
                                    <td>
                                        <% if (category.multiplo == 1) { %>
                                            <span class="badge bg-success">Sim</span>
                                        <% } else { %>
                                            <span class="badge bg-secondary">Não</span>
                                        <% } %>
                                    </td>
                                    <td>
                                        <% if (category.fluxo == 1) { %>
                                            <span class="badge bg-success">Sim</span>
                                        <% } else { %>
                                            <span class="badge bg-secondary">Não</span>
                                        <% } %>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <a href="<%= base_url('category/edit/' + category.id) %>" 
                                               class="btn btn-sm btn-outline-primary" 
                                               title="Editar">
                                                <i class="fi fi-pencil"></i>
                                            </a>
                                            <button type="button" 
                                                    class="btn btn-sm btn-danger js-ajax-confirm" 
                                                    title="Excluir"
                                                    onclick="confirmDelete(<%= category.id %>, '<%= category.name %>')">
                                                <i class="fi fi-thrash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            <% }); %>
                        </tbody>
                    </table>
                </div>
            <% } else { %>
                <div class="text-center py-5">
                    <i class="fi fi-tag fs-1 text-muted mb-3"></i>
                    <h5 class="text-muted">Nenhuma categoria encontrada</h5>
                    <p class="text-muted">Clique em "Nova Categoria" para criar a primeira categoria.</p>
                    <a href="<%= base_url('category/edit') %>" class="btn btn-primary">
                        <i class="fi fi-plus me-2"></i>Criar Categoria
                    </a>
                </div>
            <% } %>
        </div>
    </div>
</div>

<script>
function confirmDelete(id, name) {
    if (confirm('Tem certeza que deseja excluir a categoria "' + name + '"?')) {
        // Aqui você pode implementar a exclusão via AJAX ou redirecionar para uma rota de delete
        alert('Funcionalidade de exclusão será implementada posteriormente.');
    }
}
</script> 