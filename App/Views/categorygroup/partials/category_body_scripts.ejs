<script>
    $(function() {
        $('.associated-category').change(function() {
            var $sw = $(this);
            var categoryId = $sw.data('category-id');
            var groupId = $('#group-id').val();
            var checked = $sw.is(':checked');
            $sw.prop('disabled', true);
            $.ajax({
                url: `<%= base_url('group/${groupId}/category') %>`,
                method: 'POST',
                data: { category_id: categoryId, sts: checked },
                success: function(resp) {
                    $sw.prop('disabled', false);
                    if (resp && resp.error) {
                        cl.sn(resp.message, 'danger')
                        $sw.prop('checked', !checked);
                    }
                },
                error: function() {
                    $sw.prop('disabled', false);
                    cl.sn('Erro ao atualizar associação', 'danger')
                    $sw.prop('checked', !checked);
                }
            });
        });
    });
    </script> 