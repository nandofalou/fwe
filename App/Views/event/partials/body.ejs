<!-- HEADER PRINCIPAL -->
<header class="mt-lg-n6 mb-4">
    <h1 class="h4 mb-0">Cadastro de Eventos</h1>
</header>

<!-- Flash Messages -->
<% if (hasFlash('events')) { %>
    <div class="alert alert-<%= getFlash('events').type %> alert-dismissible fade show" role="alert">
        <%= getFlash('events').message %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
<% } %>

<!-- Card de Listagem -->
<div class="section rounded mb-3">
    <div class="bg-white shadow-md rounded">
        <div class="p-4 border-bottom d-flex align-items-center justify-content-between">
            <h5 class="mb-0">Lista de Eventos</h5>
            <a href="<%= base_url('event/edit') %>" class="btn btn-primary">
                <i class="fi fi-plus me-2"></i>Novo Evento
            </a>
        </div>
        <div class="p-4">
            <% if (events && events.length > 0) { %>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Data Início</th>
                                <th>Data Fim</th>
                                <th>Local</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% events.forEach(function(event) { %>
                                <tr>
                                    <td>
                                        <strong><%= event.name %></strong>
                                    </td>
                                    <td>
                                        <%= event.startdate ? new Date(event.startdate).toLocaleDateString('pt-BR') : '-' %>
                                    </td>
                                    <td>
                                        <%= event.enddate ? new Date(event.enddate).toLocaleDateString('pt-BR') : '-' %>
                                    </td>
                                    <td>
                                        <%= event.local || '-' %>
                                    </td>
                                    <td>
                                        <% if (event.active == 1) { %>
                                            <span class="badge bg-success">Ativo</span>
                                        <% } else { %>
                                            <span class="badge bg-secondary">Inativo</span>
                                        <% } %>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <a href="<%= base_url('event/edit/' + event.id) %>" 
                                               class="btn btn-sm btn-outline-primary" 
                                               title="Editar">
                                                <i class="fi fi-pencil"></i>
                                            </a>
                                            <button type="button" 
                                                    class="btn btn-sm btn-danger js-ajax-confirm" 
                                                    title="Excluir"
                                                    onclick="confirmDelete(<%= event.id %>, '<%= event.name %>')">
                                                <i class="fi fi-thrash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            <% }); %>
                        </tbody>
                    </table>
                </div>
            <% } else { %>
                <div class="text-center py-5">
                    <i class="fi fi-calendar fs-1 text-muted mb-3"></i>
                    <h5 class="text-muted">Nenhum evento encontrado</h5>
                    <p class="text-muted">Clique em "Novo Evento" para criar o primeiro evento.</p>
                    <a href="<%= base_url('event/edit') %>" class="btn btn-primary">
                        <i class="fi fi-plus me-2"></i>Criar Evento
                    </a>
                </div>
            <% } %>
        </div>
    </div>
</div>

<script>
function confirmDelete(id, name) {
    if (confirm('Tem certeza que deseja excluir o evento "' + name + '"?')) {
        // Aqui você pode implementar a exclusão via AJAX ou redirecionar para uma rota de delete
        alert('Funcionalidade de exclusão será implementada posteriormente.');
    }
}
</script> 